import { wxRequest } from '../../utils/request';
import { VERSION } from '../../utils/constant';
Page({
    app: getApp(),
    data: {
        userInfo: {},
        name: "姓名",
        uaccount: "工号",
        catelogs: [],
        changeLogs: [{
                text: '企业微信内支持选人操作',
                desc: '2021-3-12',
            }, {
                text: '支持企业微信',
                desc: '2021-2-26',
            }, {
                text: 'OA审批操作支持选择节点',
                desc: '2020-10-11',
            }, {
                text: '支持审批操作',
                desc: '2020-10-07',
            }, {
                text: '支持绑定后自动登陆',
                desc: '2020-10-05',
            }, {
                text: '初始版本上线',
                desc: '2020-10-03',
            }],
        version: VERSION,
        hasUpdate: false,
    },
    onLogout() {
        wx.reLaunch({
            url: '/pages/index/index?auto=false'
        });
    },
    getUserInfo(e) {
        const app = getApp();
        app.globalData.userInfo = e.detail.userInfo;
    },
    onLoad() {
        const { app } = this;
        const that = this;
        if (app.globalData.hasUserInfo) {
            this.setData({
                userInfo: app.globalData.userInfo,
            });
        }
        const uaccount = app.globalData.accountInfo?.uaccount;
        if (uaccount) {
            wxRequest({
                url: `https://auth.gzmpc.com/sso/webapi/account/load?uaccount=${uaccount}`,
            }).then((res) => {
                if (res.statusCode == 200) {
                    const data = res.data;
                    if (data && data.status == 200) {
                        that.setData({
                            name: data.data.accountname
                        });
                    }
                }
            });
        }
        this.setData({
            uaccount,
        });
        app.checkUpdate(function (res) {
            that.setData({
                hasUpdate: res.hasUpdate,
            });
        });
    },
});
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiZGFzaGJvYXJkLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiZGFzaGJvYXJkLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUNBLE9BQU8sRUFBRSxTQUFTLEVBQUUsTUFBTSxxQkFBcUIsQ0FBQztBQUNoRCxPQUFPLEVBQUUsT0FBTyxFQUFFLE1BQU0sc0JBQXNCLENBQUM7QUFFL0MsSUFBSSxDQUFDO0lBQ0gsR0FBRyxFQUFFLE1BQU0sRUFBYTtJQUN4QixJQUFJLEVBQUU7UUFDSixRQUFRLEVBQUUsRUFBRTtRQUNaLElBQUksRUFBRSxJQUFJO1FBQ1YsUUFBUSxFQUFFLElBQUk7UUFDZCxRQUFRLEVBQUUsRUFBRTtRQUNaLFVBQVUsRUFBRSxDQUFDO2dCQUNYLElBQUksRUFBRSxhQUFhO2dCQUNuQixJQUFJLEVBQUUsV0FBVzthQUNsQixFQUFFO2dCQUNELElBQUksRUFBRSxRQUFRO2dCQUNkLElBQUksRUFBRSxXQUFXO2FBQ2xCLEVBQUU7Z0JBQ0QsSUFBSSxFQUFFLGNBQWM7Z0JBQ3BCLElBQUksRUFBRSxZQUFZO2FBQ25CLEVBQUU7Z0JBQ0QsSUFBSSxFQUFFLFFBQVE7Z0JBQ2QsSUFBSSxFQUFFLFlBQVk7YUFDbkIsRUFBRTtnQkFDRCxJQUFJLEVBQUUsV0FBVztnQkFDakIsSUFBSSxFQUFFLFlBQVk7YUFDbkIsRUFBRTtnQkFDRCxJQUFJLEVBQUUsUUFBUTtnQkFDZCxJQUFJLEVBQUUsWUFBWTthQUNuQixDQUFDO1FBQ0YsT0FBTyxFQUFFLE9BQU87UUFDaEIsU0FBUyxFQUFFLEtBQUs7S0FDakI7SUFFRCxRQUFRO1FBSU4sRUFBRSxDQUFDLFFBQVEsQ0FBQztZQUNWLEdBQUcsRUFBRSwrQkFBK0I7U0FDckMsQ0FBQyxDQUFDO0lBSUwsQ0FBQztJQUVELFdBQVcsQ0FBQyxDQUFNO1FBQ2hCLE1BQU0sR0FBRyxHQUFHLE1BQU0sRUFBYSxDQUFDO1FBQ2hDLEdBQUcsQ0FBQyxVQUFVLENBQUMsUUFBUSxHQUFHLENBQUMsQ0FBQyxNQUFNLENBQUMsUUFBUSxDQUFBO0lBRTdDLENBQUM7SUFFRCxNQUFNO1FBQ0osTUFBTSxFQUFFLEdBQUcsRUFBRSxHQUFHLElBQUksQ0FBQztRQUNyQixNQUFNLElBQUksR0FBRyxJQUFJLENBQUM7UUFFbEIsSUFBSSxHQUFHLENBQUMsVUFBVSxDQUFDLFdBQVcsRUFBRTtZQUM5QixJQUFJLENBQUMsT0FBTyxDQUFDO2dCQUNYLFFBQVEsRUFBRSxHQUFHLENBQUMsVUFBVSxDQUFDLFFBQVE7YUFDbEMsQ0FBQyxDQUFBO1NBQ0g7UUFFRCxNQUFNLFFBQVEsR0FBRyxHQUFHLENBQUMsVUFBVSxDQUFDLFdBQVcsRUFBRSxRQUFRLENBQUM7UUFDdEQsSUFBSSxRQUFRLEVBQUU7WUFDWixTQUFTLENBQUM7Z0JBQ1IsR0FBRyxFQUFFLDJEQUEyRCxRQUFRLEVBQUU7YUFDM0UsQ0FBQyxDQUFDLElBQUksQ0FBQyxDQUFDLEdBQUcsRUFBRSxFQUFFO2dCQUNkLElBQUksR0FBRyxDQUFDLFVBQVUsSUFBSSxHQUFHLEVBQUU7b0JBQ3pCLE1BQU0sSUFBSSxHQUFRLEdBQUcsQ0FBQyxJQUFJLENBQUM7b0JBQzNCLElBQUksSUFBSSxJQUFJLElBQUksQ0FBQyxNQUFNLElBQUksR0FBRyxFQUFFO3dCQUM5QixJQUFJLENBQUMsT0FBTyxDQUFDOzRCQUNYLElBQUksRUFBRSxJQUFJLENBQUMsSUFBSSxDQUFDLFdBQVc7eUJBQzVCLENBQUMsQ0FBQztxQkFDSjtpQkFDRjtZQUNILENBQUMsQ0FBQyxDQUFDO1NBQ0o7UUFFRCxJQUFJLENBQUMsT0FBTyxDQUFDO1lBQ1gsUUFBUTtTQUNULENBQUMsQ0FBQztRQUlILEdBQUcsQ0FBQyxXQUFXLENBQUMsVUFBVSxHQUFHO1lBQzNCLElBQUksQ0FBQyxPQUFPLENBQUM7Z0JBQ1gsU0FBUyxFQUFFLEdBQUcsQ0FBQyxTQUFTO2FBQ3pCLENBQUMsQ0FBQztRQUNMLENBQUMsQ0FBQyxDQUFBO0lBQ0osQ0FBQztDQUVGLENBQUMsQ0FBQSIsInNvdXJjZXNDb250ZW50IjpbIi8vIGRhc2hib2FyZC50c1xuaW1wb3J0IHsgd3hSZXF1ZXN0IH0gZnJvbSAnLi4vLi4vdXRpbHMvcmVxdWVzdCc7XG5pbXBvcnQgeyBWRVJTSU9OIH0gZnJvbSAnLi4vLi4vdXRpbHMvY29uc3RhbnQnO1xuXG5QYWdlKHtcbiAgYXBwOiBnZXRBcHA8QnBtT3B0aW9uPigpLFxuICBkYXRhOiB7XG4gICAgdXNlckluZm86IHt9LFxuICAgIG5hbWU6IFwi5aeT5ZCNXCIsXG4gICAgdWFjY291bnQ6IFwi5bel5Y+3XCIsXG4gICAgY2F0ZWxvZ3M6IFtdLFxuICAgIGNoYW5nZUxvZ3M6IFt7XG4gICAgICB0ZXh0OiAn5LyB5Lia5b6u5L+h5YaF5pSv5oyB6YCJ5Lq65pON5L2cJyxcbiAgICAgIGRlc2M6ICcyMDIxLTMtMTInLFxuICAgIH0sIHtcbiAgICAgIHRleHQ6ICfmlK/mjIHkvIHkuJrlvq7kv6EnLFxuICAgICAgZGVzYzogJzIwMjEtMi0yNicsXG4gICAgfSwge1xuICAgICAgdGV4dDogJ09B5a6h5om55pON5L2c5pSv5oyB6YCJ5oup6IqC54K5JyxcbiAgICAgIGRlc2M6ICcyMDIwLTEwLTExJyxcbiAgICB9LCB7XG4gICAgICB0ZXh0OiAn5pSv5oyB5a6h5om55pON5L2cJyxcbiAgICAgIGRlc2M6ICcyMDIwLTEwLTA3JyxcbiAgICB9LCB7XG4gICAgICB0ZXh0OiAn5pSv5oyB57uR5a6a5ZCO6Ieq5Yqo55m76ZmGJyxcbiAgICAgIGRlc2M6ICcyMDIwLTEwLTA1JyxcbiAgICB9LCB7XG4gICAgICB0ZXh0OiAn5Yid5aeL54mI5pys5LiK57q/JyxcbiAgICAgIGRlc2M6ICcyMDIwLTEwLTAzJyxcbiAgICB9XSxcbiAgICB2ZXJzaW9uOiBWRVJTSU9OLFxuICAgIGhhc1VwZGF0ZTogZmFsc2UsXG4gIH0sXG5cbiAgb25Mb2dvdXQoKSB7XG4gICAgLy8gd3gucmVtb3ZlU3RvcmFnZSh7XG4gICAgLy8gICBrZXk6IENPTlNUQU5UX1NFU1NJT05EQVRBX0tFWSxcbiAgICAvLyAgIHN1Y2Nlc3MgKCkge1xuICAgIHd4LnJlTGF1bmNoKHtcbiAgICAgIHVybDogJy9wYWdlcy9pbmRleC9pbmRleD9hdXRvPWZhbHNlJ1xuICAgIH0pO1xuICAgIC8vIH1cbiAgICAvLyB9KVxuXG4gIH0sXG5cbiAgZ2V0VXNlckluZm8oZTogYW55KSB7XG4gICAgY29uc3QgYXBwID0gZ2V0QXBwPEJwbU9wdGlvbj4oKTtcbiAgICBhcHAuZ2xvYmFsRGF0YS51c2VySW5mbyA9IGUuZGV0YWlsLnVzZXJJbmZvXG5cbiAgfSxcblxuICBvbkxvYWQoKSB7XG4gICAgY29uc3QgeyBhcHAgfSA9IHRoaXM7XG4gICAgY29uc3QgdGhhdCA9IHRoaXM7XG5cbiAgICBpZiAoYXBwLmdsb2JhbERhdGEuaGFzVXNlckluZm8pIHtcbiAgICAgIHRoaXMuc2V0RGF0YSh7XG4gICAgICAgIHVzZXJJbmZvOiBhcHAuZ2xvYmFsRGF0YS51c2VySW5mbyxcbiAgICAgIH0pXG4gICAgfVxuXG4gICAgY29uc3QgdWFjY291bnQgPSBhcHAuZ2xvYmFsRGF0YS5hY2NvdW50SW5mbz8udWFjY291bnQ7XG4gICAgaWYgKHVhY2NvdW50KSB7XG4gICAgICB3eFJlcXVlc3Qoe1xuICAgICAgICB1cmw6IGBodHRwczovL2F1dGguZ3ptcGMuY29tL3Nzby93ZWJhcGkvYWNjb3VudC9sb2FkP3VhY2NvdW50PSR7dWFjY291bnR9YCxcbiAgICAgIH0pLnRoZW4oKHJlcykgPT4ge1xuICAgICAgICBpZiAocmVzLnN0YXR1c0NvZGUgPT0gMjAwKSB7XG4gICAgICAgICAgY29uc3QgZGF0YTogYW55ID0gcmVzLmRhdGE7XG4gICAgICAgICAgaWYgKGRhdGEgJiYgZGF0YS5zdGF0dXMgPT0gMjAwKSB7XG4gICAgICAgICAgICB0aGF0LnNldERhdGEoe1xuICAgICAgICAgICAgICBuYW1lOiBkYXRhLmRhdGEuYWNjb3VudG5hbWVcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgfVxuXG4gICAgdGhpcy5zZXREYXRhKHtcbiAgICAgIHVhY2NvdW50LFxuICAgIH0pO1xuXG5cblxuICAgIGFwcC5jaGVja1VwZGF0ZShmdW5jdGlvbiAocmVzKSB7XG4gICAgICB0aGF0LnNldERhdGEoe1xuICAgICAgICBoYXNVcGRhdGU6IHJlcy5oYXNVcGRhdGUsXG4gICAgICB9KTtcbiAgICB9KVxuICB9LFxuXG59KSJdfQ==