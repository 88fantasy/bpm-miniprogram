import { wxRequest } from '../../utils/request';
import { VERSION } from '../../utils/constant';
Page({
    app: getApp(),
    data: {
        userInfo: {},
        name: "姓名",
        uaccount: "工号",
        catelogs: [],
        changeLogs: [{
                text: 'OA审批操作支持选择节点',
                desc: '2020-10-11',
            }, {
                text: '支持审批操作',
                desc: '2020-10-07',
            }, {
                text: '支持绑定后自动登陆',
                desc: '2020-10-05',
            }, {
                text: '初始版本上线',
                desc: '2020-10-03',
            }],
        version: VERSION,
    },
    onLogout() {
        wx.reLaunch({
            url: '/pages/index/index?auto=false'
        });
    },
    getUserInfo(e) {
        const app = getApp();
        app.globalData.userInfo = e.detail.userInfo;
    },
    onLoad() {
        const { app } = this;
        const that = this;
        if (app.globalData.hasUserInfo) {
            this.setData({
                userInfo: app.globalData.userInfo,
            });
        }
        const uaccount = app.globalData.accountInfo?.uaccount;
        if (uaccount) {
            wxRequest({
                url: `https://auth.gzmpc.com/sso/webapi/account/load?uaccount=${uaccount}`,
            }).then((res) => {
                if (res.statusCode == 200) {
                    const data = res.data;
                    if (data && data.status == 200) {
                        that.setData({
                            name: data.data.accountname
                        });
                    }
                }
            });
        }
        this.setData({
            uaccount,
        });
    },
});
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiZGFzaGJvYXJkLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiZGFzaGJvYXJkLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUNBLE9BQU8sRUFBRSxTQUFTLEVBQUUsTUFBTSxxQkFBcUIsQ0FBQztBQUNoRCxPQUFPLEVBQUUsT0FBTyxFQUFHLE1BQU0sc0JBQXNCLENBQUM7QUFFaEQsSUFBSSxDQUFDO0lBQ0gsR0FBRyxFQUFFLE1BQU0sRUFBYTtJQUN4QixJQUFJLEVBQUU7UUFDSixRQUFRLEVBQUUsRUFBRTtRQUNaLElBQUksRUFBRSxJQUFJO1FBQ1YsUUFBUSxFQUFFLElBQUk7UUFDZCxRQUFRLEVBQUMsRUFBRTtRQUNYLFVBQVUsRUFBRSxDQUFDO2dCQUNYLElBQUksRUFBRSxjQUFjO2dCQUNwQixJQUFJLEVBQUUsWUFBWTthQUNuQixFQUFDO2dCQUNBLElBQUksRUFBRSxRQUFRO2dCQUNkLElBQUksRUFBRSxZQUFZO2FBQ25CLEVBQUM7Z0JBQ0EsSUFBSSxFQUFFLFdBQVc7Z0JBQ2pCLElBQUksRUFBRSxZQUFZO2FBQ25CLEVBQUM7Z0JBQ0EsSUFBSSxFQUFFLFFBQVE7Z0JBQ2QsSUFBSSxFQUFFLFlBQVk7YUFDbkIsQ0FBQztRQUNGLE9BQU8sRUFBRSxPQUFPO0tBQ2pCO0lBRUQsUUFBUTtRQUlGLEVBQUUsQ0FBQyxRQUFRLENBQUM7WUFDVixHQUFHLEVBQUUsK0JBQStCO1NBQ3JDLENBQUMsQ0FBQztJQUlULENBQUM7SUFFRCxXQUFXLENBQUMsQ0FBTTtRQUNoQixNQUFNLEdBQUcsR0FBRyxNQUFNLEVBQWEsQ0FBQztRQUNoQyxHQUFHLENBQUMsVUFBVSxDQUFDLFFBQVEsR0FBRyxDQUFDLENBQUMsTUFBTSxDQUFDLFFBQVEsQ0FBQTtJQUU3QyxDQUFDO0lBRUQsTUFBTTtRQUNKLE1BQU0sRUFBRSxHQUFHLEVBQUUsR0FBRyxJQUFJLENBQUM7UUFDckIsTUFBTSxJQUFJLEdBQUcsSUFBSSxDQUFDO1FBRWxCLElBQUcsR0FBRyxDQUFDLFVBQVUsQ0FBQyxXQUFXLEVBQUU7WUFDN0IsSUFBSSxDQUFDLE9BQU8sQ0FBQztnQkFDWCxRQUFRLEVBQUUsR0FBRyxDQUFDLFVBQVUsQ0FBQyxRQUFRO2FBQ2xDLENBQUMsQ0FBQTtTQUNIO1FBRUQsTUFBTSxRQUFRLEdBQUUsR0FBRyxDQUFDLFVBQVUsQ0FBQyxXQUFXLEVBQUUsUUFBUSxDQUFDO1FBQ3JELElBQUcsUUFBUSxFQUFFO1lBQ1gsU0FBUyxDQUFDO2dCQUNSLEdBQUcsRUFBRSwyREFBMkQsUUFBUSxFQUFFO2FBQzNFLENBQUMsQ0FBQyxJQUFJLENBQUMsQ0FBQyxHQUFHLEVBQUUsRUFBRTtnQkFDZCxJQUFHLEdBQUcsQ0FBQyxVQUFVLElBQUksR0FBRyxFQUFFO29CQUN4QixNQUFNLElBQUksR0FBUSxHQUFHLENBQUMsSUFBSSxDQUFDO29CQUMzQixJQUFHLElBQUksSUFBSSxJQUFJLENBQUMsTUFBTSxJQUFJLEdBQUcsRUFBRTt3QkFDN0IsSUFBSSxDQUFDLE9BQU8sQ0FBQzs0QkFDWCxJQUFJLEVBQUUsSUFBSSxDQUFDLElBQUksQ0FBQyxXQUFXO3lCQUM1QixDQUFDLENBQUM7cUJBQ0o7aUJBQ0Y7WUFDSCxDQUFDLENBQUMsQ0FBQztTQUNKO1FBRUQsSUFBSSxDQUFDLE9BQU8sQ0FBQztZQUNYLFFBQVE7U0FDVCxDQUFDLENBQUM7SUFFTCxDQUFDO0NBRUYsQ0FBQyxDQUFBIiwic291cmNlc0NvbnRlbnQiOlsiLy8gZGFzaGJvYXJkLnRzXG5pbXBvcnQgeyB3eFJlcXVlc3QgfSBmcm9tICcuLi8uLi91dGlscy9yZXF1ZXN0JztcbmltcG9ydCB7IFZFUlNJT04gIH0gZnJvbSAnLi4vLi4vdXRpbHMvY29uc3RhbnQnO1xuXG5QYWdlKHtcbiAgYXBwOiBnZXRBcHA8QnBtT3B0aW9uPigpLFxuICBkYXRhOiB7XG4gICAgdXNlckluZm86IHt9LFxuICAgIG5hbWU6IFwi5aeT5ZCNXCIsXG4gICAgdWFjY291bnQ6IFwi5bel5Y+3XCIsXG4gICAgY2F0ZWxvZ3M6W10sXG4gICAgY2hhbmdlTG9nczogW3tcbiAgICAgIHRleHQ6ICdPQeWuoeaJueaTjeS9nOaUr+aMgemAieaLqeiKgueCuScsXG4gICAgICBkZXNjOiAnMjAyMC0xMC0xMScsXG4gICAgfSx7XG4gICAgICB0ZXh0OiAn5pSv5oyB5a6h5om55pON5L2cJyxcbiAgICAgIGRlc2M6ICcyMDIwLTEwLTA3JyxcbiAgICB9LHtcbiAgICAgIHRleHQ6ICfmlK/mjIHnu5HlrprlkI7oh6rliqjnmbvpmYYnLFxuICAgICAgZGVzYzogJzIwMjAtMTAtMDUnLFxuICAgIH0se1xuICAgICAgdGV4dDogJ+WIneWni+eJiOacrOS4iue6vycsXG4gICAgICBkZXNjOiAnMjAyMC0xMC0wMycsXG4gICAgfV0sXG4gICAgdmVyc2lvbjogVkVSU0lPTixcbiAgfSxcblxuICBvbkxvZ291dCgpIHtcbiAgICAvLyB3eC5yZW1vdmVTdG9yYWdlKHtcbiAgICAvLyAgIGtleTogQ09OU1RBTlRfU0VTU0lPTkRBVEFfS0VZLFxuICAgIC8vICAgc3VjY2VzcyAoKSB7XG4gICAgICAgIHd4LnJlTGF1bmNoKHtcbiAgICAgICAgICB1cmw6ICcvcGFnZXMvaW5kZXgvaW5kZXg/YXV0bz1mYWxzZSdcbiAgICAgICAgfSk7XG4gICAgICAvLyB9XG4gICAgLy8gfSlcbiAgICBcbiAgfSxcblxuICBnZXRVc2VySW5mbyhlOiBhbnkpIHtcbiAgICBjb25zdCBhcHAgPSBnZXRBcHA8QnBtT3B0aW9uPigpO1xuICAgIGFwcC5nbG9iYWxEYXRhLnVzZXJJbmZvID0gZS5kZXRhaWwudXNlckluZm9cbiAgICBcbiAgfSxcbiAgIFxuICBvbkxvYWQoKSB7XG4gICAgY29uc3QgeyBhcHAgfSA9IHRoaXM7XG4gICAgY29uc3QgdGhhdCA9IHRoaXM7XG5cbiAgICBpZihhcHAuZ2xvYmFsRGF0YS5oYXNVc2VySW5mbykge1xuICAgICAgdGhpcy5zZXREYXRhKHtcbiAgICAgICAgdXNlckluZm86IGFwcC5nbG9iYWxEYXRhLnVzZXJJbmZvLFxuICAgICAgfSlcbiAgICB9XG5cbiAgICBjb25zdCB1YWNjb3VudD0gYXBwLmdsb2JhbERhdGEuYWNjb3VudEluZm8/LnVhY2NvdW50O1xuICAgIGlmKHVhY2NvdW50KSB7XG4gICAgICB3eFJlcXVlc3Qoe1xuICAgICAgICB1cmw6IGBodHRwczovL2F1dGguZ3ptcGMuY29tL3Nzby93ZWJhcGkvYWNjb3VudC9sb2FkP3VhY2NvdW50PSR7dWFjY291bnR9YCxcbiAgICAgIH0pLnRoZW4oKHJlcykgPT4ge1xuICAgICAgICBpZihyZXMuc3RhdHVzQ29kZSA9PSAyMDApIHtcbiAgICAgICAgICBjb25zdCBkYXRhOmFueSAgPSByZXMuZGF0YTtcbiAgICAgICAgICBpZihkYXRhICYmIGRhdGEuc3RhdHVzID09IDIwMCkge1xuICAgICAgICAgICAgdGhhdC5zZXREYXRhKHtcbiAgICAgICAgICAgICAgbmFtZTogZGF0YS5kYXRhLmFjY291bnRuYW1lXG4gICAgICAgICAgICB9KTsgXG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9KTtcbiAgICB9XG5cbiAgICB0aGlzLnNldERhdGEoe1xuICAgICAgdWFjY291bnQsXG4gICAgfSk7XG4gICAgXG4gIH0sXG4gIFxufSkiXX0=