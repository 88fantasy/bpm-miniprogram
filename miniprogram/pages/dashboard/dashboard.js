import { wxRequest } from '../../utils/request';
import { CONSTANT_SESSIONDATA_KEY } from '../../utils/constant';
Page({
    app: getApp(),
    data: {
        name: "姓名",
        uaccount: "工号",
        catelogs: []
    },
    onLogout() {
        wx.removeStorage({
            key: CONSTANT_SESSIONDATA_KEY,
            success() {
                wx.redirectTo({
                    url: '/pages/index/index'
                });
            }
        });
    },
    onLoad() {
        const { app } = this;
        const that = this;
        const uaccount = app.globalData.accountInfo?.uaccount;
        if (uaccount) {
            wxRequest({
                url: `https://auth.gzmpc.com/sso/webapi/account/load?uaccount=${uaccount}`,
            }).then((res) => {
                if (res.statusCode == 200) {
                    const data = res.data;
                    if (data && data.status == 200) {
                        that.setData({
                            name: data.data.accountname
                        });
                    }
                }
            });
        }
        this.setData({
            uaccount,
        });
    },
});
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiZGFzaGJvYXJkLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiZGFzaGJvYXJkLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUNBLE9BQU8sRUFBRSxTQUFTLEVBQUUsTUFBTSxxQkFBcUIsQ0FBQztBQUNoRCxPQUFPLEVBQUUsd0JBQXdCLEVBQUcsTUFBTSxzQkFBc0IsQ0FBQztBQUVqRSxJQUFJLENBQUM7SUFDSCxHQUFHLEVBQUUsTUFBTSxFQUFhO0lBQ3hCLElBQUksRUFBRTtRQUNKLElBQUksRUFBRSxJQUFJO1FBQ1YsUUFBUSxFQUFFLElBQUk7UUFDZCxRQUFRLEVBQUMsRUFBRTtLQUNaO0lBRUQsUUFBUTtRQUNOLEVBQUUsQ0FBQyxhQUFhLENBQUM7WUFDZixHQUFHLEVBQUUsd0JBQXdCO1lBQzdCLE9BQU87Z0JBQ0wsRUFBRSxDQUFDLFVBQVUsQ0FBQztvQkFDWixHQUFHLEVBQUUsb0JBQW9CO2lCQUMxQixDQUFDLENBQUM7WUFDTCxDQUFDO1NBQ0YsQ0FBQyxDQUFBO0lBRUosQ0FBQztJQUVELE1BQU07UUFDSixNQUFNLEVBQUUsR0FBRyxFQUFFLEdBQUcsSUFBSSxDQUFDO1FBQ3JCLE1BQU0sSUFBSSxHQUFHLElBQUksQ0FBQztRQUVsQixNQUFNLFFBQVEsR0FBRSxHQUFHLENBQUMsVUFBVSxDQUFDLFdBQVcsRUFBRSxRQUFRLENBQUM7UUFDckQsSUFBRyxRQUFRLEVBQUU7WUFDWCxTQUFTLENBQUM7Z0JBQ1IsR0FBRyxFQUFFLDJEQUEyRCxRQUFRLEVBQUU7YUFDM0UsQ0FBQyxDQUFDLElBQUksQ0FBQyxDQUFDLEdBQUcsRUFBRSxFQUFFO2dCQUNkLElBQUcsR0FBRyxDQUFDLFVBQVUsSUFBSSxHQUFHLEVBQUU7b0JBQ3hCLE1BQU0sSUFBSSxHQUFRLEdBQUcsQ0FBQyxJQUFJLENBQUM7b0JBQzNCLElBQUcsSUFBSSxJQUFJLElBQUksQ0FBQyxNQUFNLElBQUksR0FBRyxFQUFFO3dCQUM3QixJQUFJLENBQUMsT0FBTyxDQUFDOzRCQUNYLElBQUksRUFBRSxJQUFJLENBQUMsSUFBSSxDQUFDLFdBQVc7eUJBQzVCLENBQUMsQ0FBQztxQkFDSjtpQkFDRjtZQUNILENBQUMsQ0FBQyxDQUFDO1NBQ0o7UUFFRCxJQUFJLENBQUMsT0FBTyxDQUFDO1lBQ1gsUUFBUTtTQUNULENBQUMsQ0FBQztJQUVMLENBQUM7Q0FFRixDQUFDLENBQUEiLCJzb3VyY2VzQ29udGVudCI6WyIvLyBkYXNoYm9hcmQudHNcbmltcG9ydCB7IHd4UmVxdWVzdCB9IGZyb20gJy4uLy4uL3V0aWxzL3JlcXVlc3QnO1xuaW1wb3J0IHsgQ09OU1RBTlRfU0VTU0lPTkRBVEFfS0VZICB9IGZyb20gJy4uLy4uL3V0aWxzL2NvbnN0YW50JztcblxuUGFnZSh7XG4gIGFwcDogZ2V0QXBwPEJwbU9wdGlvbj4oKSxcbiAgZGF0YToge1xuICAgIG5hbWU6IFwi5aeT5ZCNXCIsXG4gICAgdWFjY291bnQ6IFwi5bel5Y+3XCIsXG4gICAgY2F0ZWxvZ3M6W11cbiAgfSxcblxuICBvbkxvZ291dCgpIHtcbiAgICB3eC5yZW1vdmVTdG9yYWdlKHtcbiAgICAgIGtleTogQ09OU1RBTlRfU0VTU0lPTkRBVEFfS0VZLFxuICAgICAgc3VjY2VzcyAoKSB7XG4gICAgICAgIHd4LnJlZGlyZWN0VG8oe1xuICAgICAgICAgIHVybDogJy9wYWdlcy9pbmRleC9pbmRleCdcbiAgICAgICAgfSk7XG4gICAgICB9XG4gICAgfSlcbiAgICBcbiAgfSxcbiAgIFxuICBvbkxvYWQoKSB7XG4gICAgY29uc3QgeyBhcHAgfSA9IHRoaXM7XG4gICAgY29uc3QgdGhhdCA9IHRoaXM7XG5cbiAgICBjb25zdCB1YWNjb3VudD0gYXBwLmdsb2JhbERhdGEuYWNjb3VudEluZm8/LnVhY2NvdW50O1xuICAgIGlmKHVhY2NvdW50KSB7XG4gICAgICB3eFJlcXVlc3Qoe1xuICAgICAgICB1cmw6IGBodHRwczovL2F1dGguZ3ptcGMuY29tL3Nzby93ZWJhcGkvYWNjb3VudC9sb2FkP3VhY2NvdW50PSR7dWFjY291bnR9YCxcbiAgICAgIH0pLnRoZW4oKHJlcykgPT4ge1xuICAgICAgICBpZihyZXMuc3RhdHVzQ29kZSA9PSAyMDApIHtcbiAgICAgICAgICBjb25zdCBkYXRhOmFueSAgPSByZXMuZGF0YTtcbiAgICAgICAgICBpZihkYXRhICYmIGRhdGEuc3RhdHVzID09IDIwMCkge1xuICAgICAgICAgICAgdGhhdC5zZXREYXRhKHtcbiAgICAgICAgICAgICAgbmFtZTogZGF0YS5kYXRhLmFjY291bnRuYW1lXG4gICAgICAgICAgICB9KTsgXG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9KTtcbiAgICB9XG5cbiAgICB0aGlzLnNldERhdGEoe1xuICAgICAgdWFjY291bnQsXG4gICAgfSk7XG4gICAgXG4gIH0sXG4gIFxufSkiXX0=