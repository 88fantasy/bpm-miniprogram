import { wxRequest } from '../../utils/request';
Page({
    app: getApp(),
    data: {
        userInfo: {},
        name: "姓名",
        uaccount: "工号",
        catelogs: [],
        changeLogs: [{
                text: 'OA审批操作支持选择节点',
                desc: '2020-10-11',
            }, {
                text: '支持审批操作',
                desc: '2020-10-07',
            }, {
                text: '支持绑定后自动登陆',
                desc: '2020-10-05',
            }, {
                text: '初始版本上线',
                desc: '2020-10-03',
            }],
    },
    onLogout() {
        wx.reLaunch({
            url: '/pages/index/index?auto=false'
        });
    },
    getUserInfo(e) {
        const app = getApp();
        app.globalData.userInfo = e.detail.userInfo;
    },
    onLoad() {
        const { app } = this;
        const that = this;
        if (app.globalData.hasUserInfo) {
            this.setData({
                userInfo: app.globalData.userInfo,
            });
        }
        const uaccount = app.globalData.accountInfo?.uaccount;
        if (uaccount) {
            wxRequest({
                url: `https://auth.gzmpc.com/sso/webapi/account/load?uaccount=${uaccount}`,
            }).then((res) => {
                if (res.statusCode == 200) {
                    const data = res.data;
                    if (data && data.status == 200) {
                        that.setData({
                            name: data.data.accountname
                        });
                    }
                }
            });
        }
        this.setData({
            uaccount,
        });
    },
});
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiZGFzaGJvYXJkLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiZGFzaGJvYXJkLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUNBLE9BQU8sRUFBRSxTQUFTLEVBQUUsTUFBTSxxQkFBcUIsQ0FBQztBQUdoRCxJQUFJLENBQUM7SUFDSCxHQUFHLEVBQUUsTUFBTSxFQUFhO0lBQ3hCLElBQUksRUFBRTtRQUNKLFFBQVEsRUFBRSxFQUFFO1FBQ1osSUFBSSxFQUFFLElBQUk7UUFDVixRQUFRLEVBQUUsSUFBSTtRQUNkLFFBQVEsRUFBQyxFQUFFO1FBQ1gsVUFBVSxFQUFFLENBQUM7Z0JBQ1gsSUFBSSxFQUFFLGNBQWM7Z0JBQ3BCLElBQUksRUFBRSxZQUFZO2FBQ25CLEVBQUM7Z0JBQ0EsSUFBSSxFQUFFLFFBQVE7Z0JBQ2QsSUFBSSxFQUFFLFlBQVk7YUFDbkIsRUFBQztnQkFDQSxJQUFJLEVBQUUsV0FBVztnQkFDakIsSUFBSSxFQUFFLFlBQVk7YUFDbkIsRUFBQztnQkFDQSxJQUFJLEVBQUUsUUFBUTtnQkFDZCxJQUFJLEVBQUUsWUFBWTthQUNuQixDQUFDO0tBQ0g7SUFFRCxRQUFRO1FBSUYsRUFBRSxDQUFDLFFBQVEsQ0FBQztZQUNWLEdBQUcsRUFBRSwrQkFBK0I7U0FDckMsQ0FBQyxDQUFDO0lBSVQsQ0FBQztJQUVELFdBQVcsQ0FBQyxDQUFNO1FBQ2hCLE1BQU0sR0FBRyxHQUFHLE1BQU0sRUFBYSxDQUFDO1FBQ2hDLEdBQUcsQ0FBQyxVQUFVLENBQUMsUUFBUSxHQUFHLENBQUMsQ0FBQyxNQUFNLENBQUMsUUFBUSxDQUFBO0lBRTdDLENBQUM7SUFFRCxNQUFNO1FBQ0osTUFBTSxFQUFFLEdBQUcsRUFBRSxHQUFHLElBQUksQ0FBQztRQUNyQixNQUFNLElBQUksR0FBRyxJQUFJLENBQUM7UUFFbEIsSUFBRyxHQUFHLENBQUMsVUFBVSxDQUFDLFdBQVcsRUFBRTtZQUM3QixJQUFJLENBQUMsT0FBTyxDQUFDO2dCQUNYLFFBQVEsRUFBRSxHQUFHLENBQUMsVUFBVSxDQUFDLFFBQVE7YUFDbEMsQ0FBQyxDQUFBO1NBQ0g7UUFFRCxNQUFNLFFBQVEsR0FBRSxHQUFHLENBQUMsVUFBVSxDQUFDLFdBQVcsRUFBRSxRQUFRLENBQUM7UUFDckQsSUFBRyxRQUFRLEVBQUU7WUFDWCxTQUFTLENBQUM7Z0JBQ1IsR0FBRyxFQUFFLDJEQUEyRCxRQUFRLEVBQUU7YUFDM0UsQ0FBQyxDQUFDLElBQUksQ0FBQyxDQUFDLEdBQUcsRUFBRSxFQUFFO2dCQUNkLElBQUcsR0FBRyxDQUFDLFVBQVUsSUFBSSxHQUFHLEVBQUU7b0JBQ3hCLE1BQU0sSUFBSSxHQUFRLEdBQUcsQ0FBQyxJQUFJLENBQUM7b0JBQzNCLElBQUcsSUFBSSxJQUFJLElBQUksQ0FBQyxNQUFNLElBQUksR0FBRyxFQUFFO3dCQUM3QixJQUFJLENBQUMsT0FBTyxDQUFDOzRCQUNYLElBQUksRUFBRSxJQUFJLENBQUMsSUFBSSxDQUFDLFdBQVc7eUJBQzVCLENBQUMsQ0FBQztxQkFDSjtpQkFDRjtZQUNILENBQUMsQ0FBQyxDQUFDO1NBQ0o7UUFFRCxJQUFJLENBQUMsT0FBTyxDQUFDO1lBQ1gsUUFBUTtTQUNULENBQUMsQ0FBQztJQUVMLENBQUM7Q0FFRixDQUFDLENBQUEiLCJzb3VyY2VzQ29udGVudCI6WyIvLyBkYXNoYm9hcmQudHNcbmltcG9ydCB7IHd4UmVxdWVzdCB9IGZyb20gJy4uLy4uL3V0aWxzL3JlcXVlc3QnO1xuLy8gaW1wb3J0IHsgQ09OU1RBTlRfU0VTU0lPTkRBVEFfS0VZICB9IGZyb20gJy4uLy4uL3V0aWxzL2NvbnN0YW50JztcblxuUGFnZSh7XG4gIGFwcDogZ2V0QXBwPEJwbU9wdGlvbj4oKSxcbiAgZGF0YToge1xuICAgIHVzZXJJbmZvOiB7fSxcbiAgICBuYW1lOiBcIuWnk+WQjVwiLFxuICAgIHVhY2NvdW50OiBcIuW3peWPt1wiLFxuICAgIGNhdGVsb2dzOltdLFxuICAgIGNoYW5nZUxvZ3M6IFt7XG4gICAgICB0ZXh0OiAnT0HlrqHmibnmk43kvZzmlK/mjIHpgInmi6noioLngrknLFxuICAgICAgZGVzYzogJzIwMjAtMTAtMTEnLFxuICAgIH0se1xuICAgICAgdGV4dDogJ+aUr+aMgeWuoeaJueaTjeS9nCcsXG4gICAgICBkZXNjOiAnMjAyMC0xMC0wNycsXG4gICAgfSx7XG4gICAgICB0ZXh0OiAn5pSv5oyB57uR5a6a5ZCO6Ieq5Yqo55m76ZmGJyxcbiAgICAgIGRlc2M6ICcyMDIwLTEwLTA1JyxcbiAgICB9LHtcbiAgICAgIHRleHQ6ICfliJ3lp4vniYjmnKzkuIrnur8nLFxuICAgICAgZGVzYzogJzIwMjAtMTAtMDMnLFxuICAgIH1dLFxuICB9LFxuXG4gIG9uTG9nb3V0KCkge1xuICAgIC8vIHd4LnJlbW92ZVN0b3JhZ2Uoe1xuICAgIC8vICAga2V5OiBDT05TVEFOVF9TRVNTSU9OREFUQV9LRVksXG4gICAgLy8gICBzdWNjZXNzICgpIHtcbiAgICAgICAgd3gucmVMYXVuY2goe1xuICAgICAgICAgIHVybDogJy9wYWdlcy9pbmRleC9pbmRleD9hdXRvPWZhbHNlJ1xuICAgICAgICB9KTtcbiAgICAgIC8vIH1cbiAgICAvLyB9KVxuICAgIFxuICB9LFxuXG4gIGdldFVzZXJJbmZvKGU6IGFueSkge1xuICAgIGNvbnN0IGFwcCA9IGdldEFwcDxCcG1PcHRpb24+KCk7XG4gICAgYXBwLmdsb2JhbERhdGEudXNlckluZm8gPSBlLmRldGFpbC51c2VySW5mb1xuICAgIFxuICB9LFxuICAgXG4gIG9uTG9hZCgpIHtcbiAgICBjb25zdCB7IGFwcCB9ID0gdGhpcztcbiAgICBjb25zdCB0aGF0ID0gdGhpcztcblxuICAgIGlmKGFwcC5nbG9iYWxEYXRhLmhhc1VzZXJJbmZvKSB7XG4gICAgICB0aGlzLnNldERhdGEoe1xuICAgICAgICB1c2VySW5mbzogYXBwLmdsb2JhbERhdGEudXNlckluZm8sXG4gICAgICB9KVxuICAgIH1cblxuICAgIGNvbnN0IHVhY2NvdW50PSBhcHAuZ2xvYmFsRGF0YS5hY2NvdW50SW5mbz8udWFjY291bnQ7XG4gICAgaWYodWFjY291bnQpIHtcbiAgICAgIHd4UmVxdWVzdCh7XG4gICAgICAgIHVybDogYGh0dHBzOi8vYXV0aC5nem1wYy5jb20vc3NvL3dlYmFwaS9hY2NvdW50L2xvYWQ/dWFjY291bnQ9JHt1YWNjb3VudH1gLFxuICAgICAgfSkudGhlbigocmVzKSA9PiB7XG4gICAgICAgIGlmKHJlcy5zdGF0dXNDb2RlID09IDIwMCkge1xuICAgICAgICAgIGNvbnN0IGRhdGE6YW55ICA9IHJlcy5kYXRhO1xuICAgICAgICAgIGlmKGRhdGEgJiYgZGF0YS5zdGF0dXMgPT0gMjAwKSB7XG4gICAgICAgICAgICB0aGF0LnNldERhdGEoe1xuICAgICAgICAgICAgICBuYW1lOiBkYXRhLmRhdGEuYWNjb3VudG5hbWVcbiAgICAgICAgICAgIH0pOyBcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgIH1cblxuICAgIHRoaXMuc2V0RGF0YSh7XG4gICAgICB1YWNjb3VudCxcbiAgICB9KTtcbiAgICBcbiAgfSxcbiAgXG59KSJdfQ==