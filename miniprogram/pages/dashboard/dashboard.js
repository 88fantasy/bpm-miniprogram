import { wxRequest } from '../../utils/request';
import { VERSION } from '../../utils/constant';
Page({
    app: getApp(),
    data: {
        userInfo: {},
        name: "姓名",
        uaccount: "工号",
        catelogs: [],
        changeLogs: [{
                text: '支持企业微信',
                desc: '2021-2-26',
            }, {
                text: 'OA审批操作支持选择节点',
                desc: '2020-10-11',
            }, {
                text: '支持审批操作',
                desc: '2020-10-07',
            }, {
                text: '支持绑定后自动登陆',
                desc: '2020-10-05',
            }, {
                text: '初始版本上线',
                desc: '2020-10-03',
            }],
        version: VERSION,
    },
    onLogout() {
        wx.reLaunch({
            url: '/pages/index/index?auto=false'
        });
    },
    getUserInfo(e) {
        const app = getApp();
        app.globalData.userInfo = e.detail.userInfo;
    },
    onLoad() {
        const { app } = this;
        const that = this;
        if (app.globalData.hasUserInfo) {
            this.setData({
                userInfo: app.globalData.userInfo,
            });
        }
        const uaccount = app.globalData.accountInfo?.uaccount;
        if (uaccount) {
            wxRequest({
                url: `https://auth.gzmpc.com/sso/webapi/account/load?uaccount=${uaccount}`,
            }).then((res) => {
                if (res.statusCode == 200) {
                    const data = res.data;
                    if (data && data.status == 200) {
                        that.setData({
                            name: data.data.accountname
                        });
                    }
                }
            });
        }
        this.setData({
            uaccount,
        });
    },
});
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiZGFzaGJvYXJkLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiZGFzaGJvYXJkLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUNBLE9BQU8sRUFBRSxTQUFTLEVBQUUsTUFBTSxxQkFBcUIsQ0FBQztBQUNoRCxPQUFPLEVBQUUsT0FBTyxFQUFHLE1BQU0sc0JBQXNCLENBQUM7QUFFaEQsSUFBSSxDQUFDO0lBQ0gsR0FBRyxFQUFFLE1BQU0sRUFBYTtJQUN4QixJQUFJLEVBQUU7UUFDSixRQUFRLEVBQUUsRUFBRTtRQUNaLElBQUksRUFBRSxJQUFJO1FBQ1YsUUFBUSxFQUFFLElBQUk7UUFDZCxRQUFRLEVBQUMsRUFBRTtRQUNYLFVBQVUsRUFBRSxDQUFDO2dCQUNYLElBQUksRUFBRSxRQUFRO2dCQUNkLElBQUksRUFBRSxXQUFXO2FBQ2xCLEVBQUM7Z0JBQ0EsSUFBSSxFQUFFLGNBQWM7Z0JBQ3BCLElBQUksRUFBRSxZQUFZO2FBQ25CLEVBQUM7Z0JBQ0EsSUFBSSxFQUFFLFFBQVE7Z0JBQ2QsSUFBSSxFQUFFLFlBQVk7YUFDbkIsRUFBQztnQkFDQSxJQUFJLEVBQUUsV0FBVztnQkFDakIsSUFBSSxFQUFFLFlBQVk7YUFDbkIsRUFBQztnQkFDQSxJQUFJLEVBQUUsUUFBUTtnQkFDZCxJQUFJLEVBQUUsWUFBWTthQUNuQixDQUFDO1FBQ0YsT0FBTyxFQUFFLE9BQU87S0FDakI7SUFFRCxRQUFRO1FBSUYsRUFBRSxDQUFDLFFBQVEsQ0FBQztZQUNWLEdBQUcsRUFBRSwrQkFBK0I7U0FDckMsQ0FBQyxDQUFDO0lBSVQsQ0FBQztJQUVELFdBQVcsQ0FBQyxDQUFNO1FBQ2hCLE1BQU0sR0FBRyxHQUFHLE1BQU0sRUFBYSxDQUFDO1FBQ2hDLEdBQUcsQ0FBQyxVQUFVLENBQUMsUUFBUSxHQUFHLENBQUMsQ0FBQyxNQUFNLENBQUMsUUFBUSxDQUFBO0lBRTdDLENBQUM7SUFFRCxNQUFNO1FBQ0osTUFBTSxFQUFFLEdBQUcsRUFBRSxHQUFHLElBQUksQ0FBQztRQUNyQixNQUFNLElBQUksR0FBRyxJQUFJLENBQUM7UUFFbEIsSUFBRyxHQUFHLENBQUMsVUFBVSxDQUFDLFdBQVcsRUFBRTtZQUM3QixJQUFJLENBQUMsT0FBTyxDQUFDO2dCQUNYLFFBQVEsRUFBRSxHQUFHLENBQUMsVUFBVSxDQUFDLFFBQVE7YUFDbEMsQ0FBQyxDQUFBO1NBQ0g7UUFFRCxNQUFNLFFBQVEsR0FBRSxHQUFHLENBQUMsVUFBVSxDQUFDLFdBQVcsRUFBRSxRQUFRLENBQUM7UUFDckQsSUFBRyxRQUFRLEVBQUU7WUFDWCxTQUFTLENBQUM7Z0JBQ1IsR0FBRyxFQUFFLDJEQUEyRCxRQUFRLEVBQUU7YUFDM0UsQ0FBQyxDQUFDLElBQUksQ0FBQyxDQUFDLEdBQUcsRUFBRSxFQUFFO2dCQUNkLElBQUcsR0FBRyxDQUFDLFVBQVUsSUFBSSxHQUFHLEVBQUU7b0JBQ3hCLE1BQU0sSUFBSSxHQUFRLEdBQUcsQ0FBQyxJQUFJLENBQUM7b0JBQzNCLElBQUcsSUFBSSxJQUFJLElBQUksQ0FBQyxNQUFNLElBQUksR0FBRyxFQUFFO3dCQUM3QixJQUFJLENBQUMsT0FBTyxDQUFDOzRCQUNYLElBQUksRUFBRSxJQUFJLENBQUMsSUFBSSxDQUFDLFdBQVc7eUJBQzVCLENBQUMsQ0FBQztxQkFDSjtpQkFDRjtZQUNILENBQUMsQ0FBQyxDQUFDO1NBQ0o7UUFFRCxJQUFJLENBQUMsT0FBTyxDQUFDO1lBQ1gsUUFBUTtTQUNULENBQUMsQ0FBQztJQUVMLENBQUM7Q0FFRixDQUFDLENBQUEiLCJzb3VyY2VzQ29udGVudCI6WyIvLyBkYXNoYm9hcmQudHNcbmltcG9ydCB7IHd4UmVxdWVzdCB9IGZyb20gJy4uLy4uL3V0aWxzL3JlcXVlc3QnO1xuaW1wb3J0IHsgVkVSU0lPTiAgfSBmcm9tICcuLi8uLi91dGlscy9jb25zdGFudCc7XG5cblBhZ2Uoe1xuICBhcHA6IGdldEFwcDxCcG1PcHRpb24+KCksXG4gIGRhdGE6IHtcbiAgICB1c2VySW5mbzoge30sXG4gICAgbmFtZTogXCLlp5PlkI1cIixcbiAgICB1YWNjb3VudDogXCLlt6Xlj7dcIixcbiAgICBjYXRlbG9nczpbXSxcbiAgICBjaGFuZ2VMb2dzOiBbe1xuICAgICAgdGV4dDogJ+aUr+aMgeS8geS4muW+ruS/oScsXG4gICAgICBkZXNjOiAnMjAyMS0yLTI2JyxcbiAgICB9LHtcbiAgICAgIHRleHQ6ICdPQeWuoeaJueaTjeS9nOaUr+aMgemAieaLqeiKgueCuScsXG4gICAgICBkZXNjOiAnMjAyMC0xMC0xMScsXG4gICAgfSx7XG4gICAgICB0ZXh0OiAn5pSv5oyB5a6h5om55pON5L2cJyxcbiAgICAgIGRlc2M6ICcyMDIwLTEwLTA3JyxcbiAgICB9LHtcbiAgICAgIHRleHQ6ICfmlK/mjIHnu5HlrprlkI7oh6rliqjnmbvpmYYnLFxuICAgICAgZGVzYzogJzIwMjAtMTAtMDUnLFxuICAgIH0se1xuICAgICAgdGV4dDogJ+WIneWni+eJiOacrOS4iue6vycsXG4gICAgICBkZXNjOiAnMjAyMC0xMC0wMycsXG4gICAgfV0sXG4gICAgdmVyc2lvbjogVkVSU0lPTixcbiAgfSxcblxuICBvbkxvZ291dCgpIHtcbiAgICAvLyB3eC5yZW1vdmVTdG9yYWdlKHtcbiAgICAvLyAgIGtleTogQ09OU1RBTlRfU0VTU0lPTkRBVEFfS0VZLFxuICAgIC8vICAgc3VjY2VzcyAoKSB7XG4gICAgICAgIHd4LnJlTGF1bmNoKHtcbiAgICAgICAgICB1cmw6ICcvcGFnZXMvaW5kZXgvaW5kZXg/YXV0bz1mYWxzZSdcbiAgICAgICAgfSk7XG4gICAgICAvLyB9XG4gICAgLy8gfSlcbiAgICBcbiAgfSxcblxuICBnZXRVc2VySW5mbyhlOiBhbnkpIHtcbiAgICBjb25zdCBhcHAgPSBnZXRBcHA8QnBtT3B0aW9uPigpO1xuICAgIGFwcC5nbG9iYWxEYXRhLnVzZXJJbmZvID0gZS5kZXRhaWwudXNlckluZm9cbiAgICBcbiAgfSxcbiAgIFxuICBvbkxvYWQoKSB7XG4gICAgY29uc3QgeyBhcHAgfSA9IHRoaXM7XG4gICAgY29uc3QgdGhhdCA9IHRoaXM7XG5cbiAgICBpZihhcHAuZ2xvYmFsRGF0YS5oYXNVc2VySW5mbykge1xuICAgICAgdGhpcy5zZXREYXRhKHtcbiAgICAgICAgdXNlckluZm86IGFwcC5nbG9iYWxEYXRhLnVzZXJJbmZvLFxuICAgICAgfSlcbiAgICB9XG5cbiAgICBjb25zdCB1YWNjb3VudD0gYXBwLmdsb2JhbERhdGEuYWNjb3VudEluZm8/LnVhY2NvdW50O1xuICAgIGlmKHVhY2NvdW50KSB7XG4gICAgICB3eFJlcXVlc3Qoe1xuICAgICAgICB1cmw6IGBodHRwczovL2F1dGguZ3ptcGMuY29tL3Nzby93ZWJhcGkvYWNjb3VudC9sb2FkP3VhY2NvdW50PSR7dWFjY291bnR9YCxcbiAgICAgIH0pLnRoZW4oKHJlcykgPT4ge1xuICAgICAgICBpZihyZXMuc3RhdHVzQ29kZSA9PSAyMDApIHtcbiAgICAgICAgICBjb25zdCBkYXRhOmFueSAgPSByZXMuZGF0YTtcbiAgICAgICAgICBpZihkYXRhICYmIGRhdGEuc3RhdHVzID09IDIwMCkge1xuICAgICAgICAgICAgdGhhdC5zZXREYXRhKHtcbiAgICAgICAgICAgICAgbmFtZTogZGF0YS5kYXRhLmFjY291bnRuYW1lXG4gICAgICAgICAgICB9KTsgXG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9KTtcbiAgICB9XG5cbiAgICB0aGlzLnNldERhdGEoe1xuICAgICAgdWFjY291bnQsXG4gICAgfSk7XG4gICAgXG4gIH0sXG4gIFxufSkiXX0=